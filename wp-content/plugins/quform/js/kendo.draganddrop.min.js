(typeof define=="function"&&define.amd?define:function(t,e,i){(i||e)()})("kendo.draganddrop",["kendo.core","kendo.userevents"],function(){return function(t,e){function i(t,e){return parseInt(t.css(e),10)||0}function n(t,e){return Math.min(Math.max(t,e.min),e.max)}function r(t,e){var n=E(t),r=d._outerWidth,s=d._outerHeight,o=n.left+i(t,"borderLeftWidth")+i(t,"paddingLeft"),a=n.top+i(t,"borderTopWidth")+i(t,"paddingTop");return{x:{min:o,max:o+t.width()-r(e,!0)},y:{min:a,max:a+t.height()-s(e,!0)}}}function s(t,e){var i,n=e.options.group,r=t[n];if(m.fn.destroy.call(e),r.length>1){for(i=0;i<r.length;i++)if(r[i]==e){r.splice(i,1);break}}else r.length=0,delete t[n]}function o(t){var e,i,n,r=a()[0];return t[0]===r?(i=r.scrollTop,n=r.scrollLeft,{top:i,left:n,bottom:i+p.height(),right:n+p.width()}):(e=t.offset(),e.bottom=e.top+t.height(),e.right=e.left+t.width(),e)}function a(){return t(d.support.browser.chrome?g.body:g.documentElement)}function l(e){var i=a();if(!e||e===g.body||e===g.documentElement)return i;for(var n=t(e)[0];n&&!d.isScrollable(n)&&n!==g.body;)n=n.parentNode;return n===g.body?i:t(n)}function h(t,e,i){var n={x:0,y:0};return t-i.left<50?n.x=-(50-(t-i.left)):i.right-t<50&&(n.x=50-(i.right-t)),e-i.top<50?n.y=-(50-(e-i.top)):i.bottom-e<50&&(n.y=50-(i.bottom-e)),n}var c,u,d=window.kendo,f=d.support,g=window.document,p=t(window),v=d.Class,m=d.ui.Widget,_=d.Observable,x=d.UserEvents,y=t.proxy,b=t.extend,E=d.getOffset,T={},S={},M={},w=d.elementUnderCursor,C="dragleave",D=_.extend({init:function(e,i){var n=this,r=e[0];n.capture=!1,r.addEventListener?(t.each(d.eventMap.down.split(" "),function(){r.addEventListener(this,y(n._press,n),!0)}),t.each(d.eventMap.up.split(" "),function(){r.addEventListener(this,y(n._release,n),!0)})):(t.each(d.eventMap.down.split(" "),function(){r.attachEvent(this,y(n._press,n))}),t.each(d.eventMap.up.split(" "),function(){r.attachEvent(this,y(n._release,n))})),_.fn.init.call(n),n.bind(["press","release"],i||{})},captureNext:function(){this.capture=!0},cancelCapture:function(){this.capture=!1},_press:function(t){this.trigger("press"),this.capture&&t.preventDefault()},_release:function(t){this.trigger("release"),this.capture&&(t.preventDefault(),this.cancelCapture())}}),O=_.extend({init:function(e){_.fn.init.call(this),this.forcedEnabled=!1,t.extend(this,e),this.scale=1,this.horizontal?(this.measure="offsetWidth",this.scrollSize="scrollWidth",this.axis="x"):(this.measure="offsetHeight",this.scrollSize="scrollHeight",this.axis="y")},makeVirtual:function(){t.extend(this,{virtual:!0,forcedEnabled:!0,_virtualMin:0,_virtualMax:0})},virtualSize:function(t,e){this._virtualMin===t&&this._virtualMax===e||(this._virtualMin=t,this._virtualMax=e,this.update())},outOfBounds:function(t){return t>this.max||t<this.min},forceEnabled:function(){this.forcedEnabled=!0},getSize:function(){return this.container[0][this.measure]},getTotal:function(){return this.element[0][this.scrollSize]},rescale:function(t){this.scale=t},update:function(t){var e=this.virtual?this._virtualMax:this.getTotal(),i=e*this.scale,n=this.getSize();(0!==e||this.forcedEnabled)&&(this.max=this.virtual?-this._virtualMin:0,this.size=n,this.total=i,this.min=Math.min(this.max,n-i),this.minScale=n/e,this.centerOffset=(i-n)/2,this.enabled=this.forcedEnabled||i>n,t||this.trigger("change",this))}}),k=_.extend({init:function(t){_.fn.init.call(this),this.x=new O(b({horizontal:!0},t)),this.y=new O(b({horizontal:!1},t)),this.container=t.container,this.forcedMinScale=t.minScale,this.maxScale=t.maxScale||100,this.bind("change",t)},rescale:function(t){this.x.rescale(t),this.y.rescale(t),this.refresh()},centerCoordinates:function(){return{x:Math.min(0,-this.x.centerOffset),y:Math.min(0,-this.y.centerOffset)}},refresh:function(){this.x.update(),this.y.update(),this.enabled=this.x.enabled||this.y.enabled,this.minScale=this.forcedMinScale||Math.min(this.x.minScale,this.y.minScale),this.fitScale=Math.max(this.x.minScale,this.y.minScale),this.trigger("change")}}),I=_.extend({init:function(t){b(this,t),_.fn.init.call(this)},outOfBounds:function(){return this.dimension.outOfBounds(this.movable[this.axis])},dragMove:function(t){var e=this.dimension,i=this.axis,n=this.movable,r=n[i]+t;e.enabled&&((r<e.min&&t<0||r>e.max&&t>0)&&(t*=this.resistance),n.translateAxis(i,t),this.trigger("change",this))}}),H=v.extend({init:function(e){var i,n,r,s,o=this;b(o,{elastic:!0},e),r=o.elastic?.5:0,s=o.movable,o.x=i=new I({axis:"x",dimension:o.dimensions.x,resistance:r,movable:s}),o.y=n=new I({axis:"y",dimension:o.dimensions.y,resistance:r,movable:s}),o.userEvents.bind(["press","move","end","gesturestart","gesturechange"],{gesturestart:function(t){o.gesture=t,o.offset=o.dimensions.container.offset()},press:function(e){t(e.event.target).closest("a").is("[data-navigate-on-press=true]")&&e.sender.cancel()},gesturechange:function(t){var e,r=o.gesture,a=r.center,l=t.center,h=t.distance/r.distance,c=o.dimensions.minScale,u=o.dimensions.maxScale;s.scale<=c&&h<1&&(h+=.8*(1-h)),s.scale*h>=u&&(h=u/s.scale);var d=s.x+o.offset.left,f=s.y+o.offset.top;e={x:(d-a.x)*h+l.x-d,y:(f-a.y)*h+l.y-f},s.scaleWith(h),i.dragMove(e.x),n.dragMove(e.y),o.dimensions.rescale(s.scale),o.gesture=t,t.preventDefault()},move:function(t){t.event.target.tagName.match(/textarea|input/i)||(i.dimension.enabled||n.dimension.enabled?(i.dragMove(t.x.delta),n.dragMove(t.y.delta),t.preventDefault()):t.touch.skip())},end:function(t){t.preventDefault()}})}}),W=f.transitions.prefix+"Transform";u=f.hasHW3D?function(t,e,i){return"translate3d("+t+"px,"+e+"px,0) scale("+i+")"}:function(t,e,i){return"translate("+t+"px,"+e+"px) scale("+i+")"};var z=_.extend({init:function(e){_.fn.init.call(this),this.element=t(e),this.element[0].style.webkitTransformOrigin="left top",this.x=0,this.y=0,this.scale=1,this._saveCoordinates(u(this.x,this.y,this.scale))},translateAxis:function(t,e){this[t]+=e,this.refresh()},scaleTo:function(t){this.scale=t,this.refresh()},scaleWith:function(t){this.scale*=t,this.refresh()},translate:function(t){this.x+=t.x,this.y+=t.y,this.refresh()},moveAxis:function(t,e){this[t]=e,this.refresh()},moveTo:function(t){b(this,t),this.refresh()},refresh:function(){var t,e=this.x,i=this.y;this.round&&(e=Math.round(e),i=Math.round(i)),(t=u(e,i,this.scale))!=this.coordinates&&(d.support.browser.msie&&d.support.browser.version<10?(this.element[0].style.position="absolute",this.element[0].style.left=this.x+"px",this.element[0].style.top=this.y+"px"):this.element[0].style[W]=t,this._saveCoordinates(t),this.trigger("change"))},_saveCoordinates:function(t){this.coordinates=t}}),P=m.extend({init:function(t,e){m.fn.init.call(this,t,e);var i=this.options.group;i in S?S[i].push(this):S[i]=[this]},events:["dragenter",C,"drop"],options:{name:"DropTarget",group:"default"},destroy:function(){s(S,this)},_trigger:function(t,e){var i=T[this.options.group];if(i)return this.trigger(t,b({},e.event,{draggable:i,dropTarget:e.dropTarget}))},_over:function(t){this._trigger("dragenter",t)},_out:function(t){this._trigger(C,t)},_drop:function(t){var e=T[this.options.group];e&&(e.dropped=!this._trigger("drop",t))}});P.destroyGroup=function(t){var e,i=S[t]||M[t];if(i){for(e=0;e<i.length;e++)m.fn.destroy.call(i[e]);i.length=0,delete S[t],delete M[t]}},P._cache=S;var U=P.extend({init:function(t,e){m.fn.init.call(this,t,e);var i=this.options.group;i in M?M[i].push(this):M[i]=[this]},destroy:function(){s(M,this)},options:{name:"DropTargetArea",group:"default",filter:null}}),L=m.extend({init:function(t,e){m.fn.init.call(this,t,e),this._activated=!1,this.userEvents=new x(this.element,{global:!0,allowSelection:!0,filter:this.options.filter,threshold:this.options.distance,start:y(this._start,this),hold:y(this._hold,this),move:y(this._drag,this),end:y(this._end,this),cancel:y(this._cancel,this),select:y(this._select,this)}),this._afterEndHandler=y(this._afterEnd,this),this._captureEscape=y(this._captureEscape,this)},events:["hold","dragstart","drag","dragend","dragcancel","hintDestroyed"],options:{name:"Draggable",distance:d.support.touch?0:5,group:"default",cursorOffset:null,axis:null,container:null,filter:null,ignore:null,holdToDrag:!1,autoScroll:!1,dropped:!1},cancelHold:function(){this._activated=!1},_captureEscape:function(t){t.keyCode===d.keys.ESC&&(this._trigger("dragcancel",{event:t}),this.userEvents.cancel())},_updateHint:function(e){var i,r=this.options,s=this.boundaries,o=r.axis,a=this.options.cursorOffset;a?i={left:e.x.location+a.left,top:e.y.location+a.top}:(this.hintOffset.left+=e.x.delta,this.hintOffset.top+=e.y.delta,i=t.extend({},this.hintOffset)),s&&(i.top=n(i.top,s.y),i.left=n(i.left,s.x)),"x"===o?delete i.top:"y"===o&&delete i.left,this.hint.css(i)},_shouldIgnoreTarget:function(e){var i=this.options.ignore;return i&&t(e).is(i)},_select:function(t){this._shouldIgnoreTarget(t.event.target)||t.preventDefault()},_start:function(e){var i=this,n=i.options,s=n.container,o=n.hint;if(this._shouldIgnoreTarget(e.touch.initialTouch)||n.holdToDrag&&!i._activated)i.userEvents.cancel();else{if(i.currentTarget=e.target,i.currentTargetOffset=E(i.currentTarget),o){i.hint&&i.hint.stop(!0,!0).remove(),i.hint=d.isFunction(o)?t(o.call(i,i.currentTarget)):o;var a=E(i.currentTarget);i.hintOffset=a,i.hint.css({position:"absolute",zIndex:2e4,left:a.left,top:a.top}).appendTo(g.body),i.angular("compile",function(){i.hint.removeAttr("ng-repeat");for(var n=t(e.target);!n.data("$$kendoScope")&&n.length;)n=n.parent();return{elements:i.hint.get(),scopeFrom:n.data("$$kendoScope")}})}T[n.group]=i,i.dropped=!1,s&&(i.boundaries=r(s,i.hint)),t(g).on("keyup",i._captureEscape),i._trigger("dragstart",e)&&(i.userEvents.cancel(),i._afterEnd()),i.userEvents.capture()}},_hold:function(t){this.currentTarget=t.target,this._trigger("hold",t)?this.userEvents.cancel():this._activated=!0},_drag:function(e){e.preventDefault();var i=this._elementUnderCursor(e);if(this.options.autoScroll&&this._cursorElement!==i&&(this._scrollableParent=l(i),this._cursorElement=i),this._lastEvent=e,this._processMovement(e,i),this.options.autoScroll&&this._scrollableParent[0]){var n=h(e.x.location,e.y.location,o(this._scrollableParent));this._scrollCompenstation=t.extend({},this.hintOffset),this._scrollVelocity=n,0===n.y&&0===n.x?(clearInterval(this._scrollInterval),this._scrollInterval=null):this._scrollInterval||(this._scrollInterval=setInterval(t.proxy(this,"_autoScroll"),50))}this.hint&&this._updateHint(e)},_processMovement:function(e,i){this._withDropTarget(i,function(i,n){if(i){if(c){if(n===c.targetElement)return;c._trigger(C,b(e,{dropTarget:t(c.targetElement)}))}i._trigger("dragenter",b(e,{dropTarget:t(n)})),c=b(i,{targetElement:n})}else c&&(c._trigger(C,b(e,{dropTarget:t(c.targetElement)})),c=null)}),this._trigger("drag",b(e,{dropTarget:c,elementUnderCursor:i}))},_autoScroll:function(){var t=this._scrollableParent[0],e=this._scrollVelocity,i=this._scrollCompenstation;if(t){var n=this._elementUnderCursor(this._lastEvent);this._processMovement(this._lastEvent,n);var r,s,o=t===a()[0];o?(r=g.body.scrollHeight>p.height(),s=g.body.scrollWidth>p.width()):(r=t.offsetHeight<=t.scrollHeight,s=t.offsetWidth<=t.scrollWidth);var l=t.scrollTop+e.y,h=r&&l>0&&l<t.scrollHeight,c=t.scrollLeft+e.x,u=s&&c>0&&c<t.scrollWidth;h&&(t.scrollTop+=e.y),u&&(t.scrollLeft+=e.x),this.hint&&o&&(u||h)&&(h&&(i.top+=e.y),u&&(i.left+=e.x),this.hint.css(i))}},_end:function(e){this._withDropTarget(this._elementUnderCursor(e),function(i,n){i&&(i._drop(b({},e,{dropTarget:t(n)})),c=null)}),this._cancel(this._trigger("dragend",e))},_cancel:function(t){var e=this;e._scrollableParent=null,this._cursorElement=null,clearInterval(this._scrollInterval),e._activated=!1,e.hint&&!e.dropped?setTimeout(function(){e.hint.stop(!0,!0),t?e._afterEndHandler():e.hint.animate(e.currentTargetOffset,"fast",e._afterEndHandler)},0):e._afterEnd()},_trigger:function(t,e){return this.trigger(t,b({},e.event,{x:e.x,y:e.y,currentTarget:this.currentTarget,initialTarget:e.touch?e.touch.initialTouch:null,dropTarget:e.dropTarget,elementUnderCursor:e.elementUnderCursor}))},_elementUnderCursor:function(e){var i=w(e),n=this.hint;return n&&function(e,i){try{return t.contains(e,i)||e==i}catch(n){return!1}}(n[0],i)&&(n.hide(),(i=w(e))||(i=w(e)),n.show()),i},_withDropTarget:function(i,n){var r,s=this.options.group,o=S[s],a=M[s];(o&&o.length||a&&a.length)&&((r=function(i,n,r){for(var s,o,a=0,l=n&&n.length,h=r&&r.length;i&&i.parentNode;){for(a=0;a<l;a++)if((s=n[a]).element[0]===i)return{target:s,targetElement:i};for(a=0;a<h;a++)if(o=r[a],t.contains(o.element[0],i)&&f.matchesSelector.call(i,o.options.filter))return{target:o,targetElement:i};i=i.parentNode}return e}(i,o,a))?n(r.target,r.targetElement):n())},destroy:function(){m.fn.destroy.call(this),this._afterEnd(),this.userEvents.destroy(),this._scrollableParent=null,this._cursorElement=null,clearInterval(this._scrollInterval),this.currentTarget=null},_afterEnd:function(){this.hint&&this.hint.remove(),delete T[this.options.group],this.trigger("destroy"),this.trigger("hintDestroyed"),t(g).off("keyup",this._captureEscape)}});d.ui.plugin(P),d.ui.plugin(U),d.ui.plugin(L),d.TapCapture=D,d.containerBoundaries=r,b(d.ui,{Pane:H,PaneDimensions:k,Movable:z}),d.ui.Draggable.utils={autoScrollVelocity:h,scrollableViewPort:o,findScrollableParent:l}}(window.kendo.jQuery),window.kendo});