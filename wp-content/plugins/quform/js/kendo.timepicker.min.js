(typeof define=="function"&&define.amd?define:function(t,e,i){(i||e)()})("kendo.timepicker",["kendo.popup","kendo.dateinput"],function(){return function(t,e){function i(t){return 60*t.getHours()*k+t.getMinutes()*k+1e3*t.getSeconds()+t.getMilliseconds()}function n(t,e,n){var s,o=i(e),a=i(n);return!t||o==a||(s=i(t),o>s&&(s+=x),a<o&&(a+=x),s>=o&&s<=a)}function s(t){var e=t.parseFormats;t.format=u(t.format||a.getCulture(t.culture).calendars.standard.patterns.t),(e=D(e)?e:[e]).splice(0,0,t.format),t.parseFormats=e}function o(t){t.preventDefault()}var a=window.kendo,r=a.keys,l=a.parseDate,h=a._activeElement,u=a._extractFormat,c=a.support,d=c.browser,p=a.ui,f=p.Widget,m=".kendoTimePicker",g="click"+m,_="k-state-default",v="k-state-hover",w="mousedown"+m,k=6e4,x=864e5,y="k-state-disabled",b="aria-activedescendant",D=t.isArray,T=t.extend,C=t.proxy,V=Date,F=new V;F=new V(F.getFullYear(),F.getMonth(),F.getDate(),0,0,0);var M=function(e){var i=e.id;this.options=e,this._dates=[],this.ul=t('<ul tabindex="-1" role="listbox" aria-hidden="true" unselectable="on" class="k-list k-reset"/>').css({overflow:c.kineticScrollNeeded?"":"auto"}).on(g,"li",C(this._click,this)).on("mouseenter"+m,"li",function(){t(this).addClass(v)}).on("mouseleave"+m,"li",function(){t(this).removeClass(v)}),this.list=t("<div class='k-list-container k-list-scroller' unselectable='on'/>").append(this.ul).on(w,o),i&&(this._timeViewID=i+"_timeview",this._optionID=i+"_option_selected",this.ul.attr("id",this._timeViewID)),this._popup(),this._heightHandler=C(this._height,this),this.template=a.template('<li tabindex="-1" role="option" class="k-item" unselectable="on">#=data#</li>',{useWithBlock:!1})};M.prototype={current:function(e){var i=this.options.active;if(void 0===e)return this._current;this._current&&this._current.removeClass("k-state-selected").removeAttr("aria-selected").removeAttr("id"),e&&(e=t(e).addClass("k-state-selected").attr("id",this._optionID).attr("aria-selected",!0),this.scroll(e[0])),this._current=e,i&&i(e)},close:function(){this.popup.close()},destroy:function(){this.ul.off(m),this.list.off(m),this.popup.destroy()},open:function(){this.ul[0].firstChild||this.bind(),this.popup.open(),this._current&&this.scroll(this._current[0])},dataBind:function(t){for(var e,i=this.options,s=i.format,o=a.toString,r=this.template,l=t.length,h=0,u="";h<l;h++)n(e=t[h],i.min,i.max)&&(u+=r(o(e,s,i.culture)));this._html(u)},refresh:function(){var t,e,n,s=this.options,o=s.format,r=function(){var t=new V,e=new V(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),i=new V(t.getFullYear(),t.getMonth(),t.getDate(),12,0,0);return-1*(e.getTimezoneOffset()-i.getTimezoneOffset())}(),l=r<0,h=s.min,u=s.max,c=i(h),d=i(u),p=s.interval*k,f=a.toString,m=this.template,g=new V(+h),_=g.getDate(),v=0,w="";for(n=l?(x+r*k)/p:x/p,c!=d&&(c>d&&(d+=x),n=(d-c)/p+1),e=parseInt(n,10);v<n;v++)v&&function(t,e,i){var n,s=t.getTimezoneOffset();t.setTime(t.getTime()+e),i||(n=t.getTimezoneOffset()-s,t.setTime(t.getTime()+n*k))}(g,p,l),d&&e==v&&(t=i(g),_<g.getDate()&&(t+=x),t>d&&(g=new V(+u))),this._dates.push(i(g)),w+=m(f(g,o,s.culture));this._html(w)},bind:function(){var t=this.options.dates;t&&t[0]?this.dataBind(t):this.refresh()},_html:function(t){this.ul[0].innerHTML=t,this.popup.unbind("open",this._heightHandler),this.popup.one("open",this._heightHandler),this.current(null),this.select(this._value)},scroll:function(t){if(t){var e=this.list[0],i=t.offsetTop,n=t.offsetHeight,s=e.scrollTop,o=e.clientHeight,a=i+n;s>i?s=i:a>s+o&&(s=a-o),e.scrollTop=s}},select:function(e){var i,n=this.options,s=this._current;e instanceof Date&&(e=a.toString(e,n.format,n.culture)),"string"==typeof e&&(e=s&&s.text()===e?s:(e=t.grep(this.ul[0].childNodes,function(t){return(t.textContent||t.innerText)==e}))[0]?e:null),i=this._distinctSelection(e),this.current(i)},_distinctSelection:function(e){var n,s;return e&&e.length>1&&(n=i(this._value),s=t.inArray(n,this._dates),e=this.ul.children()[s]),e},setOptions:function(t){var e=this.options;t.min=l(t.min),t.max=l(t.max),this.options=T(e,t,{active:e.active,change:e.change,close:e.close,open:e.open}),this.bind()},toggle:function(){this.popup.visible()?this.close():this.open()},value:function(t){this._value=t,this.ul[0].firstChild&&this.select(t)},_click:function(e){var i=t(e.currentTarget),n=i.text(),s=this.options.dates;s&&s.length>0&&(n=s[i.index()]),e.isDefaultPrevented()||(this.select(i),this.options.change(n,!0),this.close())},_height:function(){var t=this.list,e=t.parent(".k-animation-container"),i=this.options.height;this.ul[0].children.length&&t.add(e).show().height(this.ul[0].scrollHeight>i?i:"auto").hide()},_parse:function(t){var e=this.options,i=this._value||F;return t instanceof V?t:((t=l(t,e.parseFormats,e.culture))&&(t=new V(i.getFullYear(),i.getMonth(),i.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())),t)},_adjustListWidth:function(){var t,e,i=this.list,n=i[0].style.width,s=this.options.anchor,o=a._outerWidth;!i.data("width")&&n||(e=(t=window.getComputedStyle?window.getComputedStyle(s[0],null):0)?parseFloat(t.width):o(s),t&&(d.mozilla||d.msie)&&(e+=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)+parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth)),n=e-(o(i)-i.width()),i.css({fontFamily:s.css("font-family"),width:n}).data("width",n))},_popup:function(){var t=this.list,e=this.options,i=e.anchor;this.popup=new p.Popup(t,T(e.popup,{anchor:i,open:e.open,close:e.close,animation:e.animation,isRtl:c.isRtl(e.anchor)}))},move:function(t){var e=t.keyCode,i=this.ul[0],n=this._current,s=e===r.DOWN;if(e===r.UP||s){if(t.altKey)return void this.toggle(s);(n=s?n?n[0].nextSibling:i.firstChild:n?n[0].previousSibling:i.lastChild)&&this.select(n),this.options.change(this._current.text()),t.preventDefault()}else e!==r.ENTER&&e!==r.TAB&&e!==r.ESC||(t.preventDefault(),n&&this.options.change(n.text(),!0),this.close())}},M.getMilliseconds=i,a.TimeView=M;var S=f.extend({init:function(e,n){var o,r,h=this;f.fn.init.call(h,e,n),e=h.element,(n=h.options).min=l(e.attr("min"))||l(n.min),n.max=l(e.attr("max"))||l(n.max),s(n),h._initialOptions=T({},n),h._wrapper(),h.timeView=r=new M(T({},n,{id:e.attr("id"),anchor:h.wrapper,format:n.format,change:function(t,i){i?h._change(t):e.val(t)},open:function(t){h.timeView._adjustListWidth(),h.trigger("open")?t.preventDefault():(e.attr("aria-expanded",!0),o.attr("aria-hidden",!1))},close:function(t){h.trigger("close")?t.preventDefault():(e.attr("aria-expanded",!1),o.attr("aria-hidden",!0))},active:function(t){e.removeAttr(b),t&&e.attr(b,r._optionID)}})),o=r.ul,h._icon(),h._reset();try{e[0].setAttribute("type","text")}catch(m){e[0].type="text"}if(e.addClass("k-input").attr({role:"combobox","aria-expanded":!1,"aria-owns":r._timeViewID}),e.is("[disabled]")||t(h.element).parents("fieldset").is(":disabled")?h.enable(!1):h.readonly(e.is("[readonly]")),n.dateInput){var u=n.min,c=n.max,d=new V;i(u)==i(c)?(u=new V(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0),c=new V(d.getFullYear(),d.getMonth(),d.getDate(),24,0,0)):(u=new V(d.getFullYear(),d.getMonth(),d.getDate(),u.getHours(),u.getMinutes(),u.getSeconds(),u.getMilliseconds()),c=new V(d.getFullYear(),d.getMonth(),d.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds())),h._dateInput=new p.DateInput(e,{culture:n.culture,format:n.format,min:u,max:c,value:n.value})}h._old=h._update(n.value||h.element.val()),h._oldText=e.val(),a.notify(h)},options:{name:"TimePicker",min:F,max:F,format:"",dates:[],parseFormats:[],value:null,interval:30,height:200,animation:{},dateInput:!1},events:["open","close","change"],setOptions:function(t){var e=this._value;f.fn.setOptions.call(this,t),s(t=this.options),this.timeView.setOptions(t),e&&this.element.val(a.toString(e,t.format,t.culture))},dataBind:function(t){D(t)&&this.timeView.dataBind(t)},_editable:function(t){var e=this,i=t.disable,n=t.readonly,s=e._arrow.off(m),a=e.element.off(m),r=e._inputWrapper.off(m);n||i?(r.addClass(i?y:_).removeClass(i?_:y),a.attr("disabled",i).attr("readonly",n).attr("aria-disabled",i)):(r.addClass(_).removeClass(y).on("mouseenter.kendoTimePicker mouseleave.kendoTimePicker",e._toggleHover),a.removeAttr("disabled").removeAttr("readonly").attr("aria-disabled",!1).on("keydown"+m,C(e._keydown,e)).on("focusout"+m,C(e._blur,e)).on("focus"+m,function(){e._inputWrapper.addClass("k-state-focused")}),s.on(g,C(e._click,e)).on(w,o))},readonly:function(t){this._editable({readonly:void 0===t||t,disable:!1})},enable:function(t){this._editable({readonly:!1,disable:!(t=void 0===t||t)})},destroy:function(){f.fn.destroy.call(this),this.timeView.destroy(),this.element.off(m),this._arrow.off(m),this._inputWrapper.off(m),this._form&&this._form.off("reset",this._resetHandler)},close:function(){this.timeView.close()},open:function(){this.timeView.open()},min:function(t){return this._option("min",t)},max:function(t){return this._option("max",t)},value:function(t){if(void 0===t)return this._value;this._old=this._update(t),null===this._old&&this.element.val(""),this._oldText=this.element.val()},_blur:function(){var t=this.element.val();this.close(),t!==this._oldText&&this._change(t),this._inputWrapper.removeClass("k-state-focused")},_click:function(){var t=this.element;this.timeView.toggle(),c.touch||t[0]===h()||t.focus()},_change:function(t){t=this._update(t),+this._old!=+t&&(this._old=t,this._oldText=this.element.val(),this._typing||this.element.trigger("change"),this.trigger("change")),this._typing=!1},_icon:function(){var e,i=this.element;(e=i.next("span.k-select"))[0]||(e=t('<span unselectable="on" class="k-select" aria-label="select"><span class="k-icon k-i-clock"></span></span>').insertAfter(i)),this._arrow=e.attr({role:"button","aria-controls":this.timeView._timeViewID})},_keydown:function(t){var e=t.keyCode,i=this.timeView,n=this.element.val();i.popup.visible()||t.altKey?(i.move(t),this._dateInput&&t.stopImmediatePropagation&&t.stopImmediatePropagation()):e===r.ENTER&&n!==this._oldText?this._change(n):this._typing=!0},_option:function(t,e){var i=this.options;if(void 0===e)return i[t];(e=this.timeView._parse(e))&&(e=new V(+e),i[t]=e,this.timeView.options[t]=e,this.timeView.bind())},_toggleHover:function(e){t(e.currentTarget).toggleClass(v,"mouseenter"===e.type)},_update:function(t){var e,i=this.options,s=this.timeView,o=s._parse(t),r=this._value,l=null===o&&null===r||o instanceof Date&&r instanceof Date;return n(o,i.min,i.max)||(o=null),+o==+r&&l?((e=a.toString(o,i.format,i.culture))!==t&&this.element.val(null===o?t:e),o):(this._value=o,this._dateInput&&o?this._dateInput.value(o||t):this.element.val(a.toString(o||t,i.format,i.culture)),s.value(o),o)},_wrapper:function(){var e,i=this.element;(e=i.parents(".k-timepicker"))[0]||(e=(e=i.wrap("<span/>").parent().addClass("k-picker-wrap k-state-default")).wrap("<span/>").parent()),e[0].style.cssText=i[0].style.cssText,this.wrapper=e.addClass("k-widget k-timepicker k-header").addClass(i[0].className),i.css({width:"100%",height:i[0].style.height}),this._inputWrapper=t(e[0].firstChild)},_reset:function(){var e=this,i=e.element,n=i.attr("form"),s=n?t("#"+n):i.closest("form");s[0]&&(e._resetHandler=function(){e.value(i[0].defaultValue),e.max(e._initialOptions.max),e.min(e._initialOptions.min)},e._form=s.on("reset",e._resetHandler))}});p.plugin(S)}(window.kendo.jQuery),window.kendo});