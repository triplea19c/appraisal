var quform=function(e,t,i,o){"use strict";var n,a=e.core,s=a.cache;return n={init:function(){n.setupTooltips(),n.setupDatepickers(),s.get("#qfb-export-entries-form-id").change(function(){n.getFieldList()}),s.get("#qfb-export-all-fields").click(function(){t(".qfb-export-field").prop("checked",t(this).is(":checked"))}),s.get("#qfb_format_type").change(function(){s.get("#qfb-export-entries-csv-settings")["csv"==s.get("#qfb_format_type").val()?"qfbSlideShow":"qfbSlideHide"]()}),s.get("#qfb_format_csv_excel_compatibility").change(function(){s.get("#qfb_format_csv_delimiter").add(s.get("#qfb_format_csv_enclosure")).add(s.get("#qfb_format_csv_use_bom")).add(s.get("#qfb_format_csv_line_endings")).closest(a.settingWrap)[s.get("#qfb_format_csv_excel_compatibility").is(":checked")?"qfbSlideHide":"qfbSlideShow"]()}),s.get("#qfb_format_csv_delimiter").change(function(){s.get("#qfb_format_csv_delimiter_custom").closest(a.subSettingWrap)["custom"==s.get("#qfb_format_csv_delimiter").val()?"qfbSlideShow":"qfbSlideHide"]()}),s.get("#qfb_format_csv_enclosure").change(function(){s.get("#qfb_format_csv_enclosure_custom").closest(a.subSettingWrap)["custom"==s.get("#qfb_format_csv_enclosure").val()?"qfbSlideShow":"qfbSlideHide"]()})},setupTooltips:function(){t.isFunction(t.fn.qtip)&&t(".qfb-tooltip-icon").qtip({show:{solo:!0},style:{classes:"qtip-dark qtip-dark-quform"},content:{text:function(){return t(this).find(".qfb-tooltip-content").html()}},position:{viewport:!0},hide:{fixed:!0}})},setupDatepickers:function(){if(t.isFunction(t.fn.kendoDatePicker))var e=t("#qfb_date_from").kendoDatePicker({format:"yyyy-MM-dd",change:function(){var t=e.value(),o=i.value();t?((t=new Date(t)).setDate(t.getDate()),i.min(t)):o?(e.max(new Date(o)),i.min(new Date(1900,0,1))):(e.max(new Date(2099,11,31)),i.min(new Date(1900,0,1)))}}).data("kendoDatePicker"),i=t("#qfb_date_to").kendoDatePicker({format:"yyyy-MM-dd",change:function(){var t=i.value(),o=e.value();t?((t=new Date(t)).setDate(t.getDate()),e.max(t)):o?(i.min(new Date(o)),e.max(new Date(2099,11,31))):(e.max(new Date(2099,11,31)),i.min(new Date(1900,0,1)))}}).data("kendoDatePicker")},getFieldList:function(){s.get("#qfb-export-entries-fields-wrap").hide(),s.get("#qfb-export-entries-fields").empty(),s.get("#qfb-export-all-fields").prop("checked",!1),""!=s.get("#qfb-export-entries-form-id").val()&&(s.get(".qfb-export-entries-loading").show(),t.ajax({type:"POST",url:o.ajaxUrl,data:{action:"quform_get_export_field_list",form_id:s.get("#qfb-export-entries-form-id").val()},dataType:"json"}).done(function(e){switch((e=a.sanitiseResponse(e)).type){case"success":n.onFieldListSuccess(e.data);break;case"error":case"invalid":n.onFieldListFail(e.message)}}).fail(function(){n.onFieldListFail(o.ajaxError)}).always(function(){s.get(".qfb-export-entries-loading").hide()}))},onFieldListSuccess:function(e){for(var t=0;t<e.length;t++)s.get("#qfb-export-entries-fields").append('<div class="qfb-export-single-field"><label><input class="qfb-export-field" type="checkbox" name="qfb_columns[]" value="'+e[t].value+'"> '+e[t].label+"</label></div>");s.get("#qfb-export-entries-fields-wrap").show()},onFieldListFail:function(e){a.showFixedMessage(i.errorExportingEntries+"<br>"+e,"error")}},t(document).ready(n.init),e.tools=e.tools||{},e.tools.exportEntries=n,e}(quform,jQuery,quformToolsExportEntriesL10n,quformCoreL10n);